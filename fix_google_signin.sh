#!/bin/bash

echo "=================================="
echo "Google Sign-In Android Fix Script"
echo "=================================="
echo ""

# Get SHA-1 fingerprint
echo "üìç Step 1: Getting your SHA-1 fingerprint..."
echo ""
SHA1=$(keytool -list -v -alias androiddebugkey -keystore ~/.android/debug.keystore -storepass android 2>/dev/null | grep "SHA1:" | cut -d' ' -f3)
SHA256=$(keytool -list -v -alias androiddebugkey -keystore ~/.android/debug.keystore -storepass android 2>/dev/null | grep "SHA256:" | cut -d' ' -f3)

echo "‚úÖ Your Debug SHA-1:"
echo "   $SHA1"
echo ""
echo "‚úÖ Your Debug SHA-256:"
echo "   $SHA256"
echo ""

# Instructions
echo "=================================="
echo "üîß FOLLOW THESE STEPS:"
echo "=================================="
echo ""
echo "1Ô∏è‚É£  GO TO FIREBASE CONSOLE"
echo "   ‚Üí https://console.firebase.google.com/"
echo ""
echo "2Ô∏è‚É£  SELECT PROJECT: chalmumbai"
echo ""
echo "3Ô∏è‚É£  CLICK GEAR ICON ‚öôÔ∏è  ‚Üí Project Settings"
echo ""
echo "4Ô∏è‚É£  SCROLL DOWN TO 'Your apps' SECTION"
echo ""
echo "5Ô∏è‚É£  FIND YOUR ANDROID APP: com.kaam25.kaam25"
echo ""
echo "6Ô∏è‚É£  CLICK 'Add fingerprint' BUTTON"
echo ""
echo "7Ô∏è‚É£  PASTE THIS SHA-1:"
echo "   $SHA1"
echo ""
echo "8Ô∏è‚É£  CLICK 'Save'"
echo ""
echo "9Ô∏è‚É£  (OPTIONAL) ADD SHA-256 AS WELL:"
echo "   $SHA256"
echo ""
echo "üîü  DOWNLOAD NEW google-services.json"
echo "   ‚Üí Click on your Android app"
echo "   ‚Üí Click 'google-services.json'"
echo "   ‚Üí Replace file at: android/app/google-services.json"
echo ""
echo "=================================="
echo "AFTER ADDING SHA-1, RUN:"
echo "=================================="
echo "cd '$(pwd)'"
echo "flutter clean"
echo "flutter pub get"
echo "flutter run -d emulator-5554"
echo ""
echo "=================================="
echo "‚úÖ VERIFICATION:"
echo "=================================="
echo "After running, try Google Sign-In and check logs for:"
echo "  üîê Attempting Google sign-in..."
echo "  ‚úÖ Google sign-in successful"
echo ""
echo "If you see error code 7 or 10, SHA-1 needs to be added!"
echo "=================================="
